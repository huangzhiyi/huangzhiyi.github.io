<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=zh-CN lang=zh-cn><head><link href=//gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.80.0"><meta name=viewport content="width=device-width,initial-scale=1"><title>Spark 第八章 GraphFrames 图计算实验手册 &#183; Heis</title><link type=text/css rel=stylesheet href=https://huangzhiyi.github.io/css/heis-min.css?20210716><script>var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?f58b6a2675cf52000232edb4d109eccc";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed2.png><link rel="shortcut icon" href=/favicon2.png></head><body><style>.tooltip{position:relative;display:inline-block;border-bottom:1px dotted #000}.tooltip .tooltiptext{visibility:hidden;width:auto;max-width:200px;background-color:#000;color:#fff;text-align:center;position:absolute;z-index:1}.tooltip:hover .tooltiptext{visibility:visible;position:absolute;top:2rem;left:0;z-index:1000}</style><aside class=sidebar id=bsidebar><button id=hide-sb-btn onclick=hideSidebar()></button><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://huangzhiyi.github.io/><h1 id=side-title>Heis</h1></a><p class=lead>Long live MAMBA</p><p class=ac><a href=https://support.qq.com/products/332688 class=tooltip target=_blank><img class=tooltiptext src=https://huangzhiyi.github.io/feedback.png?20210617>
提点意见和建议»</a></p></div><nav><ul class=sidebar-nav><li><a href=https://huangzhiyi.github.io/>首页</a></li><li><a href=http://go.heisun.xyz/ target=_blank>课程导航»</a></li><li><a href=https://huangzhiyi.github.io/categories/javaweb/>Java后台应用项目开发»</a></li><li><a href=https://huangzhiyi.github.io/categories/clouddc/>云数据中心基础»</a></li><li><a href=https://huangzhiyi.github.io/categories>文章分类»</a></li><li><a href=https://huangzhiyi.github.io/tags>文章标签»</a></li><li><a href=https://heis.gitee.io/ target=_blank>镜像0：heis.gitee.io</a></li><li><a href=http://heisun.xyz/ target=_blank>镜像1：heisun.xyz</a></li><li><a href=https://huangzhiyi.github.io/ target=_blank>镜像2：huangzhiyi.github.io</a></li></ul></nav><p>&copy; 2021. All rights reserved.</p><p></p></div></aside><main class="content container" id=mainpanel><button id=show-sb-btn onclick=showSidebar()></button>
<script src=https://huangzhiyi.github.io/js/jquery-min.js></script><div class=post><h1>Spark 第八章 GraphFrames 图计算实验手册</h1><time datetime=2020-05-24T10:42:51+0800 class=post-date>2020-05-24</time><blockquote><h2>文章导航</h2><aside><nav id=TableOfContents><ul><li><a href=#实验手册版本>【实验手册版本】</a></li><li><a href=#实验81-基于-graphframes-的-pagerank-网页排名>实验8.1 ：基于 GraphFrames 的 PageRank 网页排名</a><ul><li><a href=#实验名称-实验81-基于-graphframes-的-pagerank-网页排名>【实验名称】 实验8.1 ：基于 GraphFrames 的 PageRank 网页排名</a></li><li><a href=#实验目的>【实验目的】</a></li><li><a href=#实验原理>【实验原理】</a></li><li><a href=#实验环境>【实验环境】</a></li><li><a href=#实验资源>【实验资源】</a></li><li><a href=#实验步骤>【实验步骤】</a></li><li><a href=#实验提示>【实验提示】</a></li></ul></li></ul></nav></aside></blockquote><p><a href=/spark-summary/>«返回课程汇总页面</a></p><h2 id=实验手册版本>【实验手册版本】</h2><p>当前版本号<code>v20200524</code></p><div class=tbl-start></div><table><thead><tr><th>版本</th><th>修改说明</th></tr></thead><tbody><tr><td>v20200524</td><td>初始化版本</td></tr></tbody></table><div class=tbl-end style=height:10px></div><h2 id=实验81-基于-graphframes-的-pagerank-网页排名>实验8.1 ：基于 GraphFrames 的 PageRank 网页排名</h2><h3 id=实验名称-实验81-基于-graphframes-的-pagerank-网页排名>【实验名称】 实验8.1 ：基于 GraphFrames 的 PageRank 网页排名</h3><h3 id=实验目的>【实验目的】</h3><p>理解本地向量、转换器、评估器、参数</p><h3 id=实验原理>【实验原理】</h3><ul><li>调用 GraphFrame.pageRank 进行网页排名</li></ul><h3 id=实验环境>【实验环境】</h3><ul><li>操作系统：Ubuntu 16.04</li><li>Spark：Spark2.x</li><li>开发环境：PyCharm 或 Jupyter Notebook</li><li>graphframes:graphframes:0.8.0-spark2.4-s_2.11</li></ul><h3 id=实验资源>【实验资源】</h3><p>实验数据下载</p><pre><code>https://pan.baidu.com/s/1JbaD95ObxiNXyz34KaP1Hg#提取码vkb5
</code></pre><h3 id=实验步骤>【实验步骤】</h3><ol><li><p>确保虚拟机可以联网。</p></li><li><p>运行以下命令，安装 GraphFrames 库依赖。</p></li></ol><pre><code>spark-submit --packages graphframes:graphframes:0.8.0-spark2.4-s_2.11 hello.py
</code></pre><ol start=3><li>启用开发环境。</li></ol><p>（1）如果使用 Jupyter Notebook 启动，需要加上 packages 选项和指定 graphframes 库版本。</p><pre><code>pyspark --packages graphframes:graphframes:0.8.0-spark2.4-s_2.11
</code></pre><p>（2）如果使用PyCharm，可以编写完整的py文件，使用 spark-submit 提交运行。注意加上 packages 选项和指定 graphframes 库版本。</p><pre><code>spark-submit --packages graphframes:graphframes:0.8.0-spark2.4-s_2.11 你的py文件路径
</code></pre><p>（3）从实验资源下载<code>web-Google-50K.txt</code>数据。数据使用\t符号隔开，只有2列，第1列是源ID，第二列是目标ID。</p><pre><code>0	11342
0	824020
0	867923
0	891835
...
</code></pre><p>（4）编写代码完成 pagerank 代码的编写，输出 pagerank 最高的10条记录。执行pageRank(resetProbability=0.15, maxIter=5)期望输出结果如下。</p><pre><code>+------+------------------+
|    id|          pagerank|
+------+------------------+
| 41909| 81.50190348917354|
|558791|  78.3250432743214|
|504140| 75.73723862990924|
|425770| 68.88544689620157|
|486980| 63.80154874448043|
|597621| 63.62164804496628|
| 32163| 59.56603473319442|
|172133| 58.63369599218182|
|828963|57.424930826516814|
|185821| 55.15767238107176|
+------+------------------+
</code></pre><h3 id=实验提示>【实验提示】</h3><p>请先思考再查看提示：</p><p>提示开始（鼠标选中以下空白区域会显示提示。）</p><div style=color:#fff><ul><li>（1）把数据加载到 DataFrame</li><li>（2）构造 vertices 和 edges 2个 DataFrame。其中vertices的必须列为id；edges必须的列为src（源顶点），dst（目标顶点）。</li><li>（3）构造GraphFrame，并执行pageRank</li><li>（4）对结果 vertices DataFrame 中的 pagerank 进行排序输出。</li><li>（5）由于计算量较大，可以考虑对计算出来的 DataFrame 进行缓存。</li></ul></div>提示结束</div><button id=scroll-top-btn>↑顶部</button><div id=outerdiv style=position:fixed;top:0;left:0;background:rgba(0,0,0,.7);z-index:2;width:100%;height:100%;display:none><div id=innerdiv style=position:absolute><img id=bigimg style="border:5px solid #fff" src></div><script src=https://huangzhiyi.github.io/js/highlight.pack.js></script><script src=https://huangzhiyi.github.io/js/highlightjs-line-numbers.min.js></script><script>hljs.initHighlightingOnLoad();hljs.initLineNumbersOnLoad();$(function(){$('div.tbl-start').nextUntil('div.tbl-end','table').addClass('tbl');$("img").click(function(){var _this=$(this);imgShow("#outerdiv","#innerdiv","#bigimg",_this);});$("#scroll-top-btn").click(function(){document.body.scrollTop=document.documentElement.scrollTop=0;});});</script><script src=https://huangzhiyi.github.io/js/clipboard.min.js></script><script src=https://huangzhiyi.github.io/js/codecopy.bundle.js?20210612></script></main><script src=https://huangzhiyi.github.io/js/jquery-min.js></script><script src=https://huangzhiyi.github.io/js/heis-custom-min.js?210610></script></body></html>