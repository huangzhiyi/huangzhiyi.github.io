<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=zh-CN lang=zh-cn><head><link href=//gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.80.0"><meta name=viewport content="width=device-width,initial-scale=1"><title>商务智能方法与应用第五章实验手册 &#183; Heis</title><link type=text/css rel=stylesheet href=https://huangzhiyi.github.io/css/heis-min.css?20210401-3><script>var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?f58b6a2675cf52000232edb4d109eccc";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed2.png><link rel="shortcut icon" href=/favicon2.png></head><body><style>.tooltip{position:relative;display:inline-block;border-bottom:1px dotted #000}.tooltip .tooltiptext{visibility:hidden;width:auto;max-width:200px;background-color:#000;color:#fff;text-align:center;position:absolute;z-index:1}.tooltip:hover .tooltiptext{visibility:visible;position:absolute;top:2rem;left:0;z-index:1000}</style><aside class=sidebar id=bsidebar><button id=hide-sb-btn onclick=hideSidebar()></button><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://huangzhiyi.github.io/><h1 id=side-title>Heis</h1></a><p class=lead>Long live MAMBA</p><p class=ac><a href=https://support.qq.com/products/332688 class=tooltip target=_blank><img class=tooltiptext src=https://huangzhiyi.github.io/feedback.png>
提点意见和建议»</a></p></div><nav><ul class=sidebar-nav><li><a href=https://huangzhiyi.github.io/>首页</a></li><li><a href=https://huangzhiyi.github.io/categories/hadoop/>Hadoop 部署与开发</a></li><li><a href=https://huangzhiyi.github.io/categories/hadoop-training/>Hadoop 实战»</a></li><li><a href=https://huangzhiyi.github.io/categories/spark/>Spark课程相关»</a></li><li><a href=https://huangzhiyi.github.io/categories>文章分类»</a></li><li><a href=https://huangzhiyi.github.io/tags>文章标签»</a></li><li><a href=https://heis.gitee.io/ target=_blank>镜像0：heis.gitee.io</a></li><li><a href=http://heisun.xyz/ target=_blank>镜像1：heisun.xyz</a></li><li><a href=https://huangzhiyi.github.io/ target=_blank>镜像2：huangzhiyi.github.io</a></li></ul></nav><p>&copy; 2021. All rights reserved.</p><p></p></div></aside><main class="content container" id=mainpanel><button id=show-sb-btn onclick=showSidebar()></button>
<script src=https://huangzhiyi.github.io/js/jquery-min.js></script><div class=post><h1>商务智能方法与应用第五章实验手册</h1><time datetime=2020-02-10T11:42:51+0800 class=post-date>2020-02-10</time><blockquote><h2>文章导航</h2><aside><nav id=TableOfContents><ul><li><a href=#实验手册版本>【实验手册版本】</a></li><li><a href=#实验51购物篮关联性推荐>实验5.1：购物篮关联性推荐</a><ul><li><a href=#实验名称>【实验名称】</a></li><li><a href=#实验目的>【实验目的】</a></li><li><a href=#实验内容>【实验内容】</a></li><li><a href=#实验相关知识解读>【实验相关知识解读】</a></li><li><a href=#实验环境>【实验环境】</a></li><li><a href=#实验资源>【实验资源】</a></li><li><a href=#实验步骤>【实验步骤】</a></li></ul></li></ul></nav></aside></blockquote><p><a href=/bi-summary/>«返回课程汇总页面</a></p><h2 id=实验手册版本>【实验手册版本】</h2><p>当前版本号<code>v20200331</code></p><div class=tbl-start></div><table><thead><tr><th>版本</th><th>修改说明</th></tr></thead><tbody><tr><td>v20200331</td><td>修正分析结果</td></tr><tr><td>v20200327</td><td>初始化版本</td></tr></tbody></table><div class=tbl-end style=height:10px></div><h2 id=实验51购物篮关联性推荐>实验5.1：购物篮关联性推荐</h2><h3 id=实验名称>【实验名称】</h3><p>实验5.1：购物篮关联性推荐</p><h3 id=实验目的>【实验目的】</h3><ul><li><p>熟悉并学会使用weka智能分析环境；</p></li><li><p>根据数据源建立数据模型；</p></li><li><p>根据数据模型对购物篮数据进行关联性分析；</p></li></ul><h3 id=实验内容>【实验内容】</h3><p>本实验利用weka智能分析软件，对购物篮销售数据进行关联性分析，从而得出超市如何摆放产品将有利于提高我们的销售额度。</p><h3 id=实验相关知识解读>【实验相关知识解读】</h3><ul><li><p>Apriori 算法是一种最有影响力的挖掘布尔关联规则的频繁项集的 算法，它是由Rakesh Agrawal 和RamakrishnanSkrikant 提出的。了解更多信息可以参考<a href=https://blog.csdn.net/u011067360/article/details/24810415>这篇文章</a></p></li><li><p>机器学习领域经典的 FP-growth（Frequent Pattern Growth）模型，它是目前业界经典的频繁项集和关联规则挖掘的算法。相比于 Apriori 模型，FP-growth 模型只需要扫描数据库两次，极大得减少了数据读取次数并显著得提升了算法效率。了解更多信息可以参考<a href=https://www.ibm.com/developerworks/cn/analytics/library/machine-learning-hands-on2-fp-growth/index.html>这篇文章</a></p></li><li><p>ARFF 格式指的是 Attribute-Relation File Format。可以理解为增加了列描述的 CSV 格式。文件主要分为头部（Head）信息和数据信息（Data)。头部信息定义了 Relation 和各列的 Attribute 的类型。数据部分内容和CSV一样，每列内容使用英文逗号隔开。例如下图就是一个 ARFF 格式数据。更多信息可以参考<a href=https://blog.csdn.net/Shellerine/article/details/53176891>这篇文章</a>。
<img src=/static/img/bi/bi-exp05-weka-arff-explanation.png alt></p></li></ul><h3 id=实验环境>【实验环境】</h3><ul><li>Windows 操作系统。</li><li>JDK</li><li>Weka：Weka 的全名是怀卡托智能分析环境（Waikato Environment for Knowledge Analysis），是一款免费的，非商业化（与之对应的是SPSS公司商业数据挖掘产品&ndash;Clementine ）的，基于JAVA环境下开源的机器学习（machine learning）以及数据挖掘（data mining）软件。Weka 作为一个公开的数据挖掘工作平台，集合了大量能承担数据挖掘任务的机器学习算法，包括对数据进行预处理，分类，回归、聚类、关联规则以及在新的交互式界面上的可视化。</li></ul><h3 id=实验资源>【实验资源】</h3><p>实验报告模板下载</p><pre><code>https://pan.baidu.com/s/1qqhcPcQotylS3PNP4f-edg#提取码vidt
</code></pre><p>实验数据下载</p><pre><code>https://pan.baidu.com/s/10EebwAFcqwntmweVDQ470A#提取码h8c1
</code></pre><p>Weka 网盘下载：</p><pre><code>https://pan.baidu.com/s/1dQEeVmqbyt11mZV7Uge_kQ#提取码2oev
</code></pre><p>如果网盘下载速度过慢，可以尝试从 Weka 官网下载：</p><pre><code>https://sourceforge.net/projects/weka/files/weka-3-9/3.9.4/weka-3-9-4-azul-zulu-windows.exe/download
</code></pre><h3 id=实验步骤>【实验步骤】</h3><p>1．在这个分析实验中，我们提取了某超市的购物清单其中的11个类别的数据。<code>basket.txt</code> 数据集的每一行表示一个购物清单的所有商品类别，商品类别经过去重处理，并且用Tab隔开。</p><p><img src=/static/img/bi/bi-exp05-01.png alt></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>fruitveg：新鲜蔬菜
freshmeat: 鲜肉
dairy: 乳制品
cannedveg: 蔬菜罐头
cannedmeat: 肉类罐头
frozenmeal: 冻肉
beer: 啤酒
wine: 红酒
softdrink: 软性饮料
fish: 鱼类
confectionery: 糕点糖果
</code></pre></div><ol start=3><li>为了满足 Weka 的后续分析需求。我们需要把购物类别清单的数据<code>basket.txt</code>转换为 ARFF 格式数据<code>basket.arff</code>（ARFF 数据格式可以查看【实验原理】部分了解）。每一行的购物类别清单分别对应相应的列，数据集中的空值使用英文的问号<code>?</code>代替。</li></ol><p><img src=/static/img/bi/bi-exp05-weka-arff1.png alt></p><p>可以看到</p><p><img src=/static/img/bi/bi-exp05-03.png alt></p><p>表示为了</p><p><img src=/static/img/bi/bi-exp05-weka-arff2.png alt></p><p>利用你所学过的知识，把<code>basket.txt</code>转换为<code>basket.arff</code>。形式不限，可以使用ETL工具，Python，Java，Spark 或 Hadoop 等，需要在实验报告记录你的思考过程，操作步骤或代码。以下为arff格式的固定表头，不能更改。</p><pre><code>@relation 'basket'
@attribute fruitveg {T}
@attribute freshmeat {T}
@attribute dairy {T}
@attribute cannedveg {T}
@attribute cannedmeat {T}
@attribute frozenmeal {T}
@attribute beer	{T}
@attribute wine	{T}
@attribute softdrink {T}
@attribute fish	{T}
@attribute confectionery {T}
@data
</code></pre><p>4．转换 arff 格式成功以后，我们将使用 Weka 的 Apriori 算法和 FPGrowth 算法，对购物清单类别进行关联分析，例如查看购买了 A 类商品的顾客有多大几率购买 B 类商品。</p><p>5．安装 Weka，过程略。</p><ol start=6><li>安装完毕以后，进入 Weka 的安装目录。</li></ol><p><img src=/static/img/bi/bi-exp05-weka.png alt></p><ol start=7><li>用文本编辑器打开<code>RunWeka.ini</code>，修改编码支持UTF-8。这里的修改主要是为了 Weka 能够正常识别UTF-8编码的中文。</li></ol><pre><code>#fileEncoding=Cp1252
fileEncoding=utf-8
</code></pre><p><img src=/static/img/bi/bi-exp05-weka-ini.png alt></p><ol start=8><li>双击<code>Weka 3.9.4</code>，打开 weka 的 Explorer。</li></ol><p><img src=/static/img/bi/bi-exp05-weka-open.png alt></p><p><img src=/static/img/bi/bi-exp05-weka-explorer.png alt></p><ol start=9><li>打开文件<code>basket.arff</code>。</li></ol><p><img src=/static/img/bi/bi-exp05-weka-openfile.png alt></p><p><img src=/static/img/bi/bi-exp05-weka-selectfile.png alt></p><ol start=10><li>选择关联规则挖掘<code>associate</code>，选择算法<code>Choose</code>。</li></ol><p><img src=/static/img/bi/bi-exp05-weka-choose-ass.png alt></p><ol start=11><li>选择 Apriori 算法，并点击 Apriori 配置算法参数。
<img src=/static/img/bi/bi-exp05-weka-apriori.png alt></li></ol><p><img src=/static/img/bi/bi-exp05-weka-apriori-settings.png alt></p><p>参数说明如下:</p><pre><code>car: 如果设为真，则会挖掘类关联规则而不是全局关联规则。

classindex: 类属性索引。如果设置为-1，最后的属性被当做类属性。

delta : 以此数值为迭代递减单位。不断减小支持度直至达到最小支持度或产生了满足数量要求的规则。

lowerBoundMinSupport: 最小支持度下界。

metricType:  度量类型。设置对规则进行排序的度量依据。可以是：置信度（类关联规则只能用置信度挖掘），提升度(lift)，杠杆率(leverage)，确信度(conviction)。

在 Weka中设置了几个类似置信度(confidence)的度量来衡量规则的关联程度，它们分别是：

a) Lift ： P(A,B)/(P(A)P(B)) Lift=1时表示A和B独立。这个数越大(&gt;1)，越表明A和B存在于一个购物篮中不是偶然现象,有较强的关联度.

b) Leverage :P(A,B)-P(A)P(B) Leverage=0时A和B独立，Leverage越大A和B的关系越密切

c) Conviction:P(A)P(!B)/P(A,!B) （!B表示B没有发生） Conviction也是用来衡量A和B的独立性。从它和lift的关系（对B取反，代入Lift公式后求倒数）可以看出，这个值越大, A、B越关联。

minMtric: 度量的最小值。

numRules: 要发现的规则数。

outputItemSets: 如果设置为真，会在结果中输出项集。

removeAllMissingCols: 移除全部为缺省值的列。

significanceLevel: 重要程度。重要性测试（仅用于置信度）。

upperBoundMinSupport: 最小支持度上界。 从这个值开始迭代减小最小支持度。

verbose: 如果设置为真，则算法会以冗余模式运行。
</code></pre><p>11．将minMetric设置为 0.7，设置好参数后点击<code>start</code>运行可以看到Apriori的运行结果:</p><p><img src=/static/img/bi/bi-exp05-weka-apriori-set.png alt></p><p><img src=/static/img/bi/bi-exp05-weka-apriori-start.png alt></p><p><img src=/static/img/bi/bi-exp05-weka-apriori-rs1.png alt></p><ol start=12><li>然后使用FPGrowth再来计算一次，同样的minMetric设置为 0.7，结果如下:</li></ol><p><img src=/static/img/bi/bi-exp05-weka-FPGrowth.png alt></p><p><img src=/static/img/bi/bi-exp05-weka-FPGrowth-set.png alt></p><p><img src=/static/img/bi/bi-exp05-weka-start.png alt>
可以看出，运行的结果是一样的，前三种有强关联规则的商品是</p><ul><li>(1)买了罐装蔬菜和啤酒前提下，购买冻肉置信度（confidence）为0.87（146/167）</li><li>(2)买了冻肉和啤酒前提下，购买罐装蔬菜置信度为0.86（146/170）</li><li>(3)买了罐装蔬菜和冻肉前提下，购买啤酒的置信度为0.84（146/173）</li></ul><p>由此可见，将罐装蔬菜，啤酒和冻肉摆放在一起比较能提高销售量。</p></div><button id=scroll-top-btn>↑顶部</button><div id=outerdiv style=position:fixed;top:0;left:0;background:rgba(0,0,0,.7);z-index:2;width:100%;height:100%;display:none><div id=innerdiv style=position:absolute><img id=bigimg style="border:5px solid #fff" src></div><script src=https://huangzhiyi.github.io/js/highlight.pack.js></script><script src=https://huangzhiyi.github.io/js/clipboard.min.js></script><script src=https://huangzhiyi.github.io/js/highlightjs-line-numbers.min.js></script><script>hljs.initHighlightingOnLoad();hljs.initLineNumbersOnLoad();$(function(){$('div.tbl-start').nextUntil('div.tbl-end','table').addClass('tbl');$("img").click(function(){var _this=$(this);imgShow("#outerdiv","#innerdiv","#bigimg",_this);});$("#scroll-top-btn").click(function(){document.body.scrollTop=document.documentElement.scrollTop=0;});});</script></main><script src=https://huangzhiyi.github.io/js/jquery-min.js></script><script src=https://huangzhiyi.github.io/js/heis-custom-min.js?210610></script></body></html>