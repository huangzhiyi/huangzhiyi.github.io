<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=zh-CN lang=zh-cn><head><link href=//gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.80.0"><meta name=viewport content="width=device-width,initial-scale=1"><title>商务智能方法与应用综合实验2 &#183; Heis</title><link type=text/css rel=stylesheet href=https://huangzhiyi.github.io/css/heis-min.css?51><link type=text/css id=dark_theme_css rel=stylesheet href=https://huangzhiyi.github.io/css/a11y-dark.css title=dark><link type=text/css id=light_theme_css rel="alternate stylesheet" href=https://huangzhiyi.github.io/css/a11y-light.css title=light><script>var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?f58b6a2675cf52000232edb4d109eccc";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed2.png><link rel="shortcut icon" href=/favicon2.png><script src=https://huangzhiyi.github.io/js/jquery-min.js></script></head><body><aside class=sidebar id=bsidebar><button id=hide-sb-btn onclick=hideSidebar()></button><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://huangzhiyi.github.io/><h1 id=side-title>Heis</h1></a><p class=lead>Long live MAMBA</p><p class=ac><a href=https://support.qq.com/products/332688 class=tooltip target=_blank><img class=tooltiptext src=https://huangzhiyi.github.io/feedback.png?20210617>
提点意见和建议»</a></p></div><nav><ul class=sidebar-nav><li><a href=https://huangzhiyi.github.io/>首页</a></li><li><a href=https://huangzhiyi.github.io/categories/javaweb/>Java后台应用项目开发»</a></li><li><a href=https://huangzhiyi.github.io/categories/clouddc/>云数据中心基础»</a></li><li><a href=https://huangzhiyi.github.io/categories/webtraining/>Web企业级项目实战»</a></li><li><a href=https://huangzhiyi.github.io/categories>文章分类»</a></li><li><a href=https://huangzhiyi.github.io/tags>文章标签»</a></li><li><a href=https://heis.gitee.io/ target=_blank>镜像0：heis.gitee.io</a></li><li><a href=http://heisun.xyz/ target=_blank>镜像1：heisun.xyz</a></li><li><a href=https://huangzhiyi.github.io/ target=_blank>镜像2：huangzhiyi.github.io</a></li></ul></nav><p>&copy; 2021. All rights reserved.</p><p></p></div></aside><main class="content container" id=mainpanel><button id=show-sb-btn onclick=showSidebar()></button><div class=post><h1>商务智能方法与应用综合实验2</h1><time datetime=2020-06-15T11:42:51+0800 class=post-date>2020-06-15</time><blockquote><h2>文章导航</h2><aside><nav id=TableOfContents><ul><li><a href=#实验手册版本>【实验手册版本】</a></li><li><a href=#综合练习2>综合练习2</a><ul><li><a href=#实验名称>【实验名称】</a></li><li><a href=#实验目的>【实验目的】</a></li><li><a href=#实验数据说明>【实验数据说明】</a></li><li><a href=#实验环境>【实验环境】</a></li><li><a href=#实验原理>【实验原理】</a></li><li><a href=#实验前准备>【实验前准备】</a></li><li><a href=#实验步骤>【实验步骤】</a></li><li><a href=#常见错误和解答>【常见错误和解答】</a></li></ul></li></ul></nav></aside></blockquote><p><a href=/bi-summary/>«返回课程汇总页面</a></p><div class=tbl-start></div><h2 id=实验手册版本>【实验手册版本】</h2><p>当前版本号<code>v20200615</code></p><table><thead><tr><th>版本</th><th>修改说明</th></tr></thead><tbody><tr><td>v20200615</td><td>初始化版本</td></tr></tbody></table><h2 id=综合练习2>综合练习2</h2><h3 id=实验名称>【实验名称】</h3><p>综合练习2</p><h3 id=实验目的>【实验目的】</h3><p>针对教育应用场景，练习使用关系数据库分析解决问题</p><h3 id=实验数据说明>【实验数据说明】</h3><ol><li>请从下面链接下载练习数据：</li></ol><pre><code>https://pan.baidu.com/s/1Q3kheymJorKGTxU4pChd3w#提取码kwvi
</code></pre><ol start=2><li>stu.sql 中包含了3个表，分别是<code>学生信息表stu</code>，<code>家长信息表parents</code>,<code>学生成绩表score</code>。</li></ol><ul><li>学生信息表stu</li></ul><table><thead><tr><th>列</th><th>备注</th></tr></thead><tbody><tr><td>id</td><td>主键</td></tr><tr><td>stuid</td><td>学号</td></tr><tr><td>name</td><td>姓名</td></tr><tr><td>gender</td><td>性别</td></tr><tr><td>clazz</td><td>班级</td></tr></tbody></table><ul><li>家长信息表parents</li></ul><table><thead><tr><th>列</th><th>备注</th></tr></thead><tbody><tr><td>id</td><td>主键</td></tr><tr><td>stuid</td><td>学号</td></tr><tr><td>fname</td><td>父亲姓名</td></tr><tr><td>fphone</td><td>父亲手机号</td></tr><tr><td>fname</td><td>母亲姓名</td></tr><tr><td>fphone</td><td>母亲手机号</td></tr></tbody></table><ul><li>学生成绩表score</li></ul><table><thead><tr><th>列</th><th>备注</th></tr></thead><tbody><tr><td>id</td><td>主键</td></tr><tr><td>testid</td><td>考试ID</td></tr><tr><td>stuid</td><td>学号</td></tr><tr><td>chn</td><td>语文成绩</td></tr><tr><td>math</td><td>数学成绩</td></tr><tr><td>eng</td><td>英语成绩</td></tr><tr><td>tot</td><td>总分</td></tr></tbody></table><h3 id=实验环境>【实验环境】</h3><ul><li>操作系统：Windows</li><li>MySQL</li><li>MySQL Workbench/Navicat/HeidiSQL</li></ul><h3 id=实验原理>【实验原理】</h3><ul><li>SQL 常用语法模板</li></ul><pre><code>select 表名1.列名1 as 别名1,表名2.列名2 as 别名2, ...
from 表名1 表别名1,表名2 表别名2
where 条件语句
group by 列名
order by 列名 asc|desc
</code></pre><p>例子：</p><pre><code>SELECT s.stuid AS 学号,s.name AS '姓名',sc.chn AS 语文成绩  FROM stu s,score sc WHERE s.stuid=sc.stuid
</code></pre><ul><li>SQL 连接语法模板</li></ul><p>（1）连接可以分为内连接（inner join），左外连接（left join ），右外连接（right join）</p><pre><code>select * from TableA a join TableB b on a.id=b.id
</code></pre><ul><li>语法说明</li></ul><p>（1）`符号（Esc键下面）通常可以括列名和表名，如果列名或表名和 SQL 语句里面的关键字有冲突可以使用。</p><p>（2）单引号 ' 用来包围字符串。</p><h3 id=实验前准备>【实验前准备】</h3><ol><li><p>运行 MySQL 数据库，并打开MySQL客户端（MySQL Workbench/Navicat/HeidiSQL）使用 root 用户连接。</p></li><li><p>创建一个stu数据库。</p></li></ol><pre><code>create database stu;
use stu;
</code></pre><ol start=3><li>运行stu.sql 脚本，创建三个表格stu、score和parents。</li></ol><h3 id=实验步骤>【实验步骤】</h3><p>请按照以下要求完成SQL语句。</p><ol><li>按班级统计男女人数</li></ol><ul><li><p>关键知识点：count，group by，order by</p></li><li><p>展示要求如下表所示：</p></li></ul><table><thead><tr><th>班级</th><th>性别</th><th>人数</th></tr></thead><tbody><tr><td>三1班</td><td>男</td><td>？</td></tr><tr><td>三1班</td><td>女</td><td>？</td></tr><tr><td>三2班</td><td>男</td><td>？</td></tr><tr><td>三2班</td><td>女</td><td>？</td></tr></tbody></table><ul><li>期望结果：</li></ul><p><img src=/static/img/bi/Snipaste_2020-06-16_16-49-36.png alt></p><hr><ol start=2><li>统计三1班和三2班语文成绩90分或以上的人数</li></ol><ul><li><p>关键知识点：join，count，group by</p></li><li><p>展示要求如下表所示：</p></li></ul><table><thead><tr><th>班级</th><th>人数</th></tr></thead><tbody><tr><td>三1班</td><td>？</td></tr><tr><td>三2班</td><td>？</td></tr></tbody></table><ul><li>期望结果：</li></ul><p><img src=/static/img/bi/Snipaste_2020-06-16_16-55-11.png alt></p><hr><ol start=3><li>查找家长姓名为<code>李迁迁</code>的学生姓名和班级</li></ol><ul><li><p>关键知识点：表连接，where 条件</p></li><li><p>展示要求如下表所示：</p></li></ul><table><thead><tr><th>姓名</th><th>班级</th><th>父亲姓名</th><th>母亲姓名</th></tr></thead><tbody><tr><td>？</td><td>？</td><td>？</td><td>？</td></tr></tbody></table><ul><li>期望结果：</li></ul><p><img src=/static/img/bi/Snipaste_2020-06-16_16-56-11.png alt></p><hr><ol start=4><li>查找三1班和三2班学生该次考试（testid=1011)的总分的平均分</li></ol><ul><li><p>关键知识点：表连接，group by，avg函数，format函数</p></li><li><p>展示要求如下表所示：</p></li></ul><table><thead><tr><th>班级</th><th>平均分</th></tr></thead><tbody><tr><td>三1班</td><td>？</td></tr><tr><td>三2班</td><td>？</td></tr></tbody></table><ul><li>期望结果：</li></ul><p><img src=/static/img/bi/Snipaste_2020-06-16_17-01-22.png alt></p><hr><ol start=5><li>查找三2班该次考试（testid=1011)总分前5名的学生</li></ol><ul><li><p>关键知识点：表连接，order by，limit</p></li><li><p>展示要求如下表所示：</p></li></ul><table><thead><tr><th>姓名</th><th>班级</th><th>总分</th></tr></thead><tbody><tr><td>？</td><td>三2班</td><td>？</td></tr><tr><td>？</td><td>三2班</td><td>？</td></tr><tr><td>？</td><td>三2班</td><td>？</td></tr><tr><td>？</td><td>三2班</td><td>？</td></tr><tr><td>？</td><td>三2班</td><td>？</td></tr></tbody></table><ul><li>期望结果：</li></ul><p><img src=/static/img/bi/Snipaste_2020-06-16_17-01-55.png alt></p><hr><ol start=6><li>按表格格式呈现三1班语文科成绩各个分数层人数，包括90(含)以上，,75(含)-90、60(含)-75。</li></ol><ul><li><p>关键知识点：join，count，union，case语句</p></li><li><p>展示要求如下表所示：</p></li></ul><table><thead><tr><th>分数层</th><th>人数</th></tr></thead><tbody><tr><td>90以上</td><td>？</td></tr><tr><td>75以下</td><td>？</td></tr><tr><td>75-90</td><td>？</td></tr></tbody></table><ul><li>期望结果：</li></ul><p><img src=/static/img/bi/Snipaste_2020-06-16_17-02-31.png alt></p><hr><ol start=7><li>为了方便给学生家长发送成绩短信，需要构造以下内容进行个性化发送，短信模板如下：</li></ol><blockquote><p>尊敬的[学生姓名]家长，你好。[学生姓名]期末成绩为语文[语文成绩]，数学[数学成绩]，英语[英语成绩]，总分[总分成绩]。</p></blockquote><ul><li><p>关键知识点：join，字符连接concat，union，子查询</p></li><li><p>展示要求如下表所示：</p></li></ul><p>注：这里注意学生如果有2位家长留有手机号，则2位都需要发送。</p><table><thead><tr><th>学生姓名</th><th>班级</th><th>家长姓名</th><th>家长手机号</th><th>短信内容</th></tr></thead><tbody><tr><td>柏倩利</td><td>三1班</td><td>柏松山</td><td>13763410385</td><td>尊敬的柏倩利家长，你好。柏倩利期末成绩为语文69，数学64，英语73，总分206。</td></tr><tr><td>遇济深</td><td>三2班</td><td>遇金龙</td><td>13827221156</td><td>尊敬的遇济深家长，你好。遇济深期末成绩为语文78，数学71，英语96，总分245。</td></tr></tbody></table><ul><li>期望结果：</li></ul><p><img src=/static/img/bi/Snipaste_2020-06-16_17-03-06.png alt></p><div class=tbl-end style=height:10px></div><h3 id=常见错误和解答>【常见错误和解答】</h3><ul><li>错误1：SQL 语法结构不清晰，基本的select、from、where等关键字顺序和位置不清楚。</li></ul><p>答：参考上面“SQL 常用语法模板”。</p><ul><li>错误2：使用双引号"来包围字符串。</li></ul><p>答：应该使用单引号'。</p><ul><li>错误3：使用2个等号“==”来进行等值判断条件。</li></ul><p>答：等值判断应该使用1个<code>=</code>，不等于可以使用<code>!=</code>或<code>&lt;></code>。</p><ul><li>错误4：使用聚合函数如count,sum等没有配合使用<code>group by</code>进行分组。</li></ul><p>答：应该要根据分组的列来使用group by。</p></div><button id=scroll-top-btn>↑顶部</button>
<button id=switch-theme-btn>换主题</button><div id=outerdiv style=position:fixed;top:0;left:0;background:rgba(0,0,0,.7);z-index:2;width:100%;height:100%;display:none><div id=innerdiv style=position:absolute><img id=bigimg style="border:5px solid #fff" src></div></div><div id=category style=display:none;position:fixed;right:10px;bottom:10px;width:10em></div><script src=https://huangzhiyi.github.io/js/highlight.pack.js></script><script src=https://huangzhiyi.github.io/js/highlightjs-line-numbers.min.js></script><script>hljs.initHighlightingOnLoad();hljs.initLineNumbersOnLoad();$(function(){let curTheme=getCookie("theme");if(curTheme===""){setTheme("dark");}else{setTheme(curTheme);}
$('div.tbl-start').nextUntil('div.tbl-end','table').addClass('tbl');$("img").click(function(){var _this=$(this);imgShow("#outerdiv","#innerdiv","#bigimg",_this);});$("#scroll-top-btn").click(function(){document.body.scrollTop=document.documentElement.scrollTop=0;});$("#switch-theme-btn").click(function(){switchTheme();})});</script><script src=https://huangzhiyi.github.io/js/clipboard.min.js?></script><script src=https://huangzhiyi.github.io/js/codecopy.bundle.js?331></script></main><script src=https://huangzhiyi.github.io/js/heis-custom-min.js?671></script></body></html>