<!doctype html><html lang=zh><meta charset=utf-8><meta name=viewport content="width=device-width"><title>SQL 练习 1 | Heis</title><meta name=generator content="Hugo Eureka 0.8.4"><link rel=stylesheet href=/css/eureka.min.css><script defer src=/js/eureka.min.js></script><script src=/static/js/jquery-3.6.0.min.js></script><script src=/static/js/heis.js></script><script src=/static/js/alasql-1.7.js></script><script src=/static/js/json-to-table.min.js></script><script src=/static/js/lodash.core.min.js></script><link rel=stylesheet href=/static/css/heis.css media=print onload="this.media='all';this.onload=null" crossorigin><link rel=stylesheet href=/static/css/highlight-css/solarized-light.min.css media=print onload="this.media='all';this.onload=null" crossorigin><script defer src=/static/js/highlight.min.js crossorigin></script><script defer src=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/js/all.min.js integrity="sha256-uNYoXefWRqv+PsIF/OflNmwtKM4lStn9yrz2gVl6ymo=" crossorigin></script><script defer src=/static/js/highlightjs-line-numbers.min.js></script><link rel=icon type=image/png sizes=32x32 href=/images/icon_hu64421c6c7700f606f0ad45d807017b09_5843_32x32_fill_box_center_2.png><link rel=apple-touch-icon sizes=180x180 href=/images/icon_hu64421c6c7700f606f0ad45d807017b09_5843_180x180_fill_box_center_2.png><meta name=description content="SQL 练习 1"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"文章","item":"/posts/"},{"@type":"ListItem","position":2,"name":"SQL 练习 1","item":"/posts/sql-training1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/sql-training1/"},"headline":"SQL 练习 1 | Heis","datePublished":"2021-04-26T00:44:00+08:00","dateModified":"2021-04-26T00:44:00+08:00","wordCount":7265,"publisher":{"@type":"Person","name":"C. Wang","logo":{"@type":"ImageObject","url":"/images/icon.png"}},"description":"SQL 练习 1"}</script><meta property="og:title" content="SQL 练习 1 | Heis"><meta property="og:type" content="article"><meta property="og:image" content="/images/icon.png"><meta property="og:url" content="/posts/sql-training1/"><meta property="og:description" content="SQL 练习 1"><meta property="og:locale" content="zh"><meta property="og:site_name" content="Heis"><meta property="article:published_time" content="2021-04-26T00:44:00+08:00"><meta property="article:modified_time" content="2021-04-26T00:44:00+08:00"><meta property="article:section" content="posts"><meta property="article:tag" content="SQL"><meta property="article:tag" content="练习"><meta property="article:tag" content="数据库"><meta property="article:tag" content="Database"><meta property="og:see_also" content="/docs/spark-exp/spark-exp05/"><script>var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?f58b6a2675cf52000232edb4d109eccc";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script><body class="flex flex-col min-h-screen"><header class="fixed flex items-center w-full min-h-16 pl-scrollbar z-50 bg-secondary-bg shadow-sm"><div class="w-full max-w-screen-xl mx-auto"><script>let storageColorScheme=localStorage.getItem("lightDarkMode")
if(((storageColorScheme=='Auto'||storageColorScheme==null)&&window.matchMedia("(prefers-color-scheme: dark)").matches)||storageColorScheme=="Dark"){document.getElementsByTagName('html')[0].classList.add('dark')}</script><nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0"><a href=/ class="mr-6 text-primary-text text-xl font-bold">Heis</a>
<button id=navbar-btn class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
<i class="fas fa-bars"></i></button><div id=target class="hidden block md:flex md:flex-grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20"><div class="md:flex md:h-16 text-sm md:flex-grow pb-4 md:pb-0 border-b md:border-b-0"><a href=/posts/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 selected-menu-item mr-4">文章</a>
<a href=/docs/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent mr-4">课程文档</a></div><div class=flex><div class="relative pt-4 md:pt-0"><div class="cursor-pointer hover:text-eureka" id=lightDarkMode><i class="fas fa-adjust"></i></div><div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id=is-open></div><div class="absolute flex flex-col left-0 md:left-auto right-auto md:right-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40" id=lightDarkOptions><span class="px-4 py-1 hover:text-eureka" name=Light>浅色</span>
<span class="px-4 py-1 hover:text-eureka" name=Dark>深色</span>
<span class="px-4 py-1 hover:text-eureka" name=Auto>自动</span></div></div></div></div><div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id=is-open-mobile></div></nav><script>let element=document.getElementById('lightDarkMode')
if(storageColorScheme==null||storageColorScheme=='Auto'){document.addEventListener('DOMContentLoaded',()=>{window.matchMedia("(prefers-color-scheme: dark)").addEventListener('change',switchDarkMode)})}else if(storageColorScheme=="Light"){element.firstElementChild.classList.remove('fa-adjust')
element.firstElementChild.setAttribute("data-icon",'sun')
element.firstElementChild.classList.add('fa-sun')}else if(storageColorScheme=="Dark"){element.firstElementChild.classList.remove('fa-adjust')
element.firstElementChild.setAttribute("data-icon",'moon')
element.firstElementChild.classList.add('fa-moon')}
document.addEventListener('DOMContentLoaded',()=>{getcolorscheme();switchBurger();});</script></div></header><main class="flex-grow pt-16"><div class=pl-scrollbar><div class="w-full max-w-screen-xl lg:px-4 xl:px-8 mx-auto"><div class="grid grid-cols-2 lg:grid-cols-8 gap-4 lg:pt-12"><div class="col-span-2 lg:col-span-6 bg-secondary-bg rounded px-6 py-8"><h1 class="font-bold text-3xl text-primary-text">SQL 练习 1</h1><div class="flex flex-wrap flex-row items-center mt-2 text-tertiary-text"><div class="mr-6 my-2"><i class="fas fa-calendar mr-1"></i><span>2021-04-26</span></div><div class="mr-6 my-2"><i class="fas fa-clock mr-1"></i><span>15分钟阅读时长</span></div><div class="mr-6 my-2"><i class="fas fa-folder mr-1"></i><a href=/categories/database/ class=hover:text-eureka>Database</a>
<span>,</span>
<a href=/categories/sql/ class=hover:text-eureka>SQL</a></div></div><div class=content><h2 id=sql-练习-1>SQL 练习 1</h2><h2 id=版本>【版本】</h2><p>当前版本号<code>v20210515</code></p><div class=tbl-start></div><table><thead><tr><th>版本</th><th>修改说明</th></tr></thead><tbody><tr><td>v20210515</td><td>新增题目9-12</td></tr><tr><td>v20210429</td><td>初始化</td></tr></tbody></table><div class=tbl-end style=height:10px></div><h3 id=实验名称>【实验名称】</h3><p>SQL 练习 1</p><h3 id=实验目的>【实验目的】</h3><ul><li>熟练 SQL 的使用</li></ul><h3 id=实验环境>【实验环境】</h3><ul><li>Chrome 等现代浏览器</li></ul><h3 id=实验数据>【实验数据】</h3><ul><li>表 <code>gdp</code> 包含国内（不含港澳台）2018年和2019年的 GDP 数据。</li></ul><div class=tbl-start></div><table><thead><tr><th>列</th><th>说明</th></tr></thead><tbody><tr><td>dist</td><td>省市地区</td></tr><tr><td>n2018</td><td>2018年GDP（单位：亿）</td></tr><tr><td>n2019</td><td>2019年GDP（单位：亿）</td></tr></tbody></table><div class=tbl-end style=height:10px></div><ul><li>表 <code>population</code> 包含国内（不含港澳台）2018年和2019年的常住人口数量数据。</li></ul><div class=tbl-start></div><table><thead><tr><th>列</th><th>说明</th></tr></thead><tbody><tr><td>dist</td><td>省市地区</td></tr><tr><td>n2018</td><td>2018年人口数量（单位：万）</td></tr><tr><td>n2019</td><td>2019年人口数量（单位：万）</td></tr></tbody></table><div class=tbl-end style=height:10px></div><ul><li>表 <code>ecodist</code> 是国内各省市（不含港澳台）经济区域划分。</li></ul><div class=tbl-start></div><table><thead><tr><th>列</th><th>说明</th></tr></thead><tbody><tr><td>dist</td><td>省市地区</td></tr><tr><td>ecogrp</td><td>经济区域</td></tr></tbody></table><div class=tbl-end style=height:10px></div><h3 id=实验步骤>【实验步骤】</h3><ol><li>查找广东2019年的 GDP。需要展示列（dist,n2019）。
关键字：<code>where</code></li></ol><div class=sql-panel><div class=sql-input><textarea id=ta1 placeholder="请输入 SQL ……" class=sql-input></textarea></div><div style=text-align:right;width:100% class=btn-panel><button class=exebtn id=btn1>执行(Ctrl+Enter)</button>
<button class=exebtn id=clearbtn1>清除</button></div><div id=testmsg1 class=msg></div><div id=msg1 class=msg></div><div id=rs1 class=rs></div></div><ol start=2><li>查找2019年的 GDP 排名前5名，按降序排列。需要展示列（dist,n2019）。
关键字：<code>order by</code> <code>limit</code></li></ol><div class=sql-panel><div class=sql-input><textarea id=ta2 placeholder="请输入 SQL ……" class=sql-input></textarea></div><div class=btn-panel><button class=exebtn id=btn2>执行(Ctrl+Enter)</button>
<button class=exebtn id=clearbtn2>清除</button></div><div id=testmsg2 class=msg></div><div id=msg2 class=msg></div><div id=rs2 class=rs></div></div><ol start=3><li>查找2019年相对于2018年的 GDP 增长率排名前5名，按降序排列。需要展示列 dist、growth（增长率百分比，精确到小数点后1位，例如北京增长16.7）。
关键字： <code>子查询</code> <code>round</code> <code>order by</code> <code>limit</code></li></ol><div class=sql-panel><div class=sql-input><textarea id=ta3 placeholder="请输入 SQL ……" class=sql-input></textarea></div><div class=btn-panel><button class=exebtn id=btn3>执行(Ctrl+Enter)</button>
<button class=exebtn id=clearbtn3>清除</button></div><div id=testmsg3 class=msg></div><div id=msg3 class=msg></div><div id=rs3 class=rs></div></div><ol start=4><li>统计泛珠三角省份（福建、江西、湖南、广东、广西、海南、四川、贵州、云南）的2018年和2019年人口总数。需要展示列 n2018、n2019。
关键字： <code>sum</code></li></ol><div class=sql-panel><div class=sql-input><textarea id=ta4 placeholder="请输入 SQL ……" class=sql-input></textarea></div><div class=btn-panel><button class=exebtn id=btn4>执行(Ctrl+Enter)</button>
<button class=exebtn id=clearbtn4>清除</button></div><div id=testmsg4 class=msg></div><div id=msg4 class=msg></div><div id=rs4 class=rs></div></div><ol start=5><li>统计2019年各个经济区域的 GDP 总数，按 GDP 总数降序排列。需要展示列 ecogrp（经济区域），gdpsum（GDP总数，精确到小数点后1位）。关键字： <code>sum</code> <code>group by</code> <code>join</code></li></ol><div class=sql-panel><div class=sql-input><textarea id=ta5 placeholder="请输入 SQL ……" class=sql-input></textarea></div><div class=btn-panel><button class=exebtn id=btn5>执行(Ctrl+Enter)</button>
<button class=exebtn id=clearbtn5>清除</button></div><div id=testmsg5 class=msg></div><div id=msg5 class=msg></div><div id=rs5 class=rs></div></div><ol start=6><li>列出所有的经济区域。需要展示列 ecogrp（经济区域）。关键字： <code>distinct</code></li></ol><div class=sql-panel><div class=sql-input><textarea id=ta6 placeholder="请输入 SQL ……" class=sql-input></textarea></div><div class=btn-panel><button class=exebtn id=btn6>执行(Ctrl+Enter)</button>
<button class=exebtn id=clearbtn6>清除</button></div><div id=testmsg6 class=msg></div><div id=msg6 class=msg></div><div id=rs6 class=rs></div></div><ol start=7><li>统计2019年人均 GDP 最高的10个地区，按人均 GDP 降序排列。需要展示列 dist（区域），pergdp（人均GDP，万/人，精确到小数点后1位）。关键字： <code>join</code> <code>limit</code> <code>round</code></li></ol><div class=sql-panel><div class=sql-input><textarea id=ta7 placeholder="请输入 SQL ……" class=sql-input></textarea></div><div class=btn-panel><button class=exebtn id=btn7>执行(Ctrl+Enter)</button>
<button class=exebtn id=clearbtn7>清除</button></div><div id=testmsg7 class=msg></div><div id=msg7 class=msg></div><div id=rs7 class=rs></div></div><ol start=8><li>找出2018年GDP第2高的地区。需要展示列 dist（区域），n2018。关键字： <code>offset</code></li></ol><div class=sql-panel><div class=sql-input><textarea id=ta8 placeholder="请输入 SQL ……" class=sql-input></textarea></div><div class=btn-panel><button class=exebtn id=btn8>执行(Ctrl+Enter)</button>
<button class=exebtn id=clearbtn8>清除</button></div><div id=testmsg8 class=msg></div><div id=msg8 class=msg></div><div id=rs8 class=rs></div></div><ol start=9><li>查找东北三省2018年和2019年的平均GDP。需要展示列dist（显示&rsquo;东北三省平均'），avg2018（2018省份平均GDP，四舍五入到小数点后1位），avg2019（2019省份平均GDP，四舍五入到小数点后1位）。关键字： <code>AVG</code> <code>ROUND</code></li></ol><div class=sql-panel><div class=sql-input><textarea id=ta9 placeholder="请输入 SQL ……" class=sql-input></textarea></div><div class=btn-panel><button class=exebtn id=btn9>执行(Ctrl+Enter)</button>
<button class=exebtn id=clearbtn9>清除</button></div><div id=testmsg9 class=msg></div><div id=msg9 class=msg></div><div id=rs9 class=rs></div></div><ol start=10><li>统计所有地区人口总数2019相对于2018年的增长率。需要展示列 rate（显示格式 XX.XX%，四舍五入到百分比小数点后2位）。关键字： <code>CONCAT</code> <code>ROUND</code> <code>SUM</code></li></ol><div class=sql-panel><div class=sql-input><textarea id=ta10 placeholder="请输入 SQL ……" class=sql-input></textarea></div><div class=btn-panel><button class=exebtn id=btn10>执行(Ctrl+Enter)</button>
<button class=exebtn id=clearbtn10>清除</button></div><div id=testmsg10 class=msg></div><div id=msg10 class=msg></div><div id=rs10 class=rs></div></div><ol start=11><li>统计2019年相对2018年人口减少最多前3个地区。需要展示列 dist（地区），num(减少数量，显示负数)。关键字： <code>ORDER BY</code></li></ol><div class=sql-panel><div class=sql-input><textarea id=ta11 placeholder="请输入 SQL ……" class=sql-input></textarea></div><div class=btn-panel><button class=exebtn id=btn11>执行(Ctrl+Enter)</button>
<button class=exebtn id=clearbtn11>清除</button></div><div id=testmsg11 class=msg></div><div id=msg11 class=msg></div><div id=rs11 class=rs></div></div><ol start=12><li>统计2019年相对2018年人口和GDP同时增长的地区。需要展示列 dist（地区），popnum（人口增加数量，优先排序，降序），gdpinc（GDP增长量，四舍五入小数点后1位，降序）。关键字： <code>ORDER BY</code></li></ol><div class=sql-panel><div class=sql-input><textarea id=ta12 placeholder="请输入 SQL ……" class=sql-input></textarea></div><div class=btn-panel><button class=exebtn id=btn12>执行(Ctrl+Enter)</button>
<button class=exebtn id=clearbtn12>清除</button></div><div id=testmsg12 class=msg></div><div id=msg12 class=msg></div><div id=rs12 class=rs></div></div><script>const{jsonToHTMLTable}=JSONToTable;const expectedrs={"1":[{"dist":"广东","n2019":107671.1}],"2":[{"dist":"广东","n2019":107671.1},{"dist":"江苏","n2019":99631.5},{"dist":"山东","n2019":71067.5},{"dist":"浙江","n2019":62352},{"dist":"河南","n2019":54259.2}],"3":[{"dist":"云南","growth":29.9},{"dist":"安徽","growth":23.7},{"dist":"福建","growth":18.4},{"dist":"上海","growth":16.8},{"dist":"北京","growth":16.7}],"4":[{"n2018":49465,"n2019":49839}],"5":[{"ecogrp":"东部","gdpsum":511161.3},{"ecogrp":"中部","gdpsum":211007},{"ecogrp":"西部","gdpsum":205185},{"ecogrp":"东北","gdpsum":50249}],"6":[{"ecogrp":"东部"},{"ecogrp":"中部"},{"ecogrp":"西部"},{"ecogrp":"东北"}],"7":[{"dist":"北京","pergdp":16.4},{"dist":"上海","pergdp":15.7},{"dist":"江苏","pergdp":12.3},{"dist":"浙江","pergdp":10.7},{"dist":"福建","pergdp":10.7},{"dist":"广东","pergdp":9.3},{"dist":"天津","pergdp":9},{"dist":"湖北","pergdp":7.7},{"dist":"重庆","pergdp":7.6},{"dist":"山东","pergdp":7.1}],"8":[{"dist":"江苏","n2018":92595.4}],"9":[{"dist":"东北三省平均","avg2018":18917.2,"avg2019":16749.7}],"10":[{"rate":"0.54%"}],"11":[{"dist":"黑龙江","num":-22},{"dist":"吉林","num":-13},{"dist":"辽宁","num":-7}],"12":[{"dist":"广东","popnum":175,"gdpinc":10393.3},{"dist":"浙江","popnum":113,"gdpinc":6154.8},{"dist":"安徽","popnum":42,"gdpinc":7107.2},{"dist":"甘肃","popnum":37,"gdpinc":472},{"dist":"新疆","popnum":36,"gdpinc":1398},{"dist":"河北","popnum":36,"gdpinc":-906},{"dist":"河南","popnum":35,"gdpinc":6203.3},{"dist":"四川","popnum":34,"gdpinc":5937.7},{"dist":"广西","popnum":34,"gdpinc":884.6},{"dist":"福建","popnum":32,"gdpinc":6591},{"dist":"云南","popnum":28,"gdpinc":5342.7},{"dist":"贵州","popnum":23,"gdpinc":1962.8},{"dist":"山东","popnum":23,"gdpinc":-5402.2},{"dist":"重庆","popnum":22,"gdpinc":3242.6},{"dist":"江苏","popnum":19,"gdpinc":7036.1},{"dist":"湖南","popnum":19,"gdpinc":3326.3},{"dist":"江西","popnum":18,"gdpinc":-4958.1},{"dist":"陕西","popnum":12,"gdpinc":1354.9},{"dist":"海南","popnum":11,"gdpinc":476.9},{"dist":"山西","popnum":11,"gdpinc":208.6},{"dist":"湖北","popnum":10,"gdpinc":6461.7},{"dist":"西藏","popnum":7,"gdpinc":220.2},{"dist":"宁夏","popnum":7,"gdpinc":43.3},{"dist":"内蒙古","popnum":6,"gdpinc":-76.7},{"dist":"青海","popnum":5,"gdpinc":100.8},{"dist":"上海","popnum":4,"gdpinc":5475.4},{"dist":"天津","popnum":2,"gdpinc":-4705.3},{"dist":"北京","popnum":0,"gdpinc":5051.3},{"dist":"辽宁","popnum":-7,"gdpinc":-405.9},{"dist":"吉林","popnum":-13,"gdpinc":-3347.8},{"dist":"黑龙江","popnum":-22,"gdpinc":-2748.9}],};alasql("CREATE TABLE population (dist string, n2018 number,n2019 number)");alasql("CREATE TABLE gdp (dist string, n2018 number,n2019 number)");alasql("CREATE TABLE ecodist (dist string, ecogrp string)");alasql.tables.population.data=[{"dist":"广东","n2018":11346,"n2019":11521},{"dist":"山东","n2018":10047,"n2019":10070},{"dist":"河南","n2018":9605,"n2019":9640},{"dist":"四川","n2018":8341,"n2019":8375},{"dist":"江苏","n2018":8051,"n2019":8070},{"dist":"河北","n2018":7556,"n2019":7592},{"dist":"湖南","n2018":6899,"n2019":6918},{"dist":"安徽","n2018":6324,"n2019":6366},{"dist":"湖北","n2018":5917,"n2019":5927},{"dist":"浙江","n2018":5737,"n2019":5850},{"dist":"广西","n2018":4926,"n2019":4960},{"dist":"云南","n2018":4830,"n2019":4858},{"dist":"江西","n2018":4648,"n2019":4666},{"dist":"辽宁","n2018":4359,"n2019":4352},{"dist":"福建","n2018":3941,"n2019":3973},{"dist":"陕西","n2018":3864,"n2019":3876},{"dist":"黑龙江","n2018":3773,"n2019":3751},{"dist":"山西","n2018":3718,"n2019":3729},{"dist":"贵州","n2018":3600,"n2019":3623},{"dist":"重庆","n2018":3102,"n2019":3124},{"dist":"吉林","n2018":2704,"n2019":2691},{"dist":"甘肃","n2018":2637,"n2019":2674},{"dist":"内蒙古","n2018":2534,"n2019":2540},{"dist":"上海","n2018":2424,"n2019":2428},{"dist":"新疆","n2018":2487,"n2019":2523},{"dist":"北京","n2018":2154,"n2019":2154},{"dist":"天津","n2018":1560,"n2019":1562},{"dist":"海南","n2018":934,"n2019":945},{"dist":"宁夏","n2018":688,"n2019":695},{"dist":"青海","n2018":603,"n2019":608},{"dist":"西藏","n2018":344,"n2019":351},];alasql.tables.gdp.data=[{"dist":"北京","n2018":30320.0,"n2019":35371.3},{"dist":"天津","n2018":18809.6,"n2019":14104.3},{"dist":"河北","n2018":36010.3,"n2019":35104.3},{"dist":"山西","n2018":16818.1,"n2019":17026.7},{"dist":"内蒙古","n2018":17289.2,"n2019":17212.5},{"dist":"辽宁","n2018":25315.4,"n2019":24909.5},{"dist":"吉林","n2018":15074.6,"n2019":11726.8},{"dist":"黑龙江","n2018":16361.6,"n2019":13612.7},{"dist":"上海","n2018":32679.9,"n2019":38155.3},{"dist":"江苏","n2018":92595.4,"n2019":99631.5},{"dist":"浙江","n2018":56197.2,"n2019":62352.0},{"dist":"安徽","n2018":30006.8,"n2019":37114.0},{"dist":"福建","n2018":35804.0,"n2019":42395.0},{"dist":"江西","n2018":21984.8,"n2019":17026.7},{"dist":"山东","n2018":76469.7,"n2019":71067.5},{"dist":"河南","n2018":48055.9,"n2019":54259.2},{"dist":"湖北","n2018":39366.6,"n2019":45828.3},{"dist":"湖南","n2018":36425.8,"n2019":39752.1},{"dist":"广东","n2018":97277.8,"n2019":107671.1},{"dist":"广西","n2018":20352.5,"n2019":21237.1},{"dist":"海南","n2018":4832.1,"n2019":5309.0},{"dist":"重庆","n2018":20363.2,"n2019":23605.8},{"dist":"四川","n2018":40678.1,"n2019":46615.8},{"dist":"贵州","n2018":14806.5,"n2019":16769.3},{"dist":"云南","n2018":17881.1,"n2019":23223.8},{"dist":"西藏","n2018":1477.6,"n2019":1697.8},{"dist":"陕西","n2018":24438.3,"n2019":25793.2},{"dist":"甘肃","n2018":8246.1,"n2019":8718.1},{"dist":"青海","n2018":2865.2,"n2019":2966.0},{"dist":"宁夏","n2018":3705.2,"n2019":3748.5},{"dist":"新疆","n2018":12199.1,"n2019":13597.1},];alasql.tables.ecodist.data=[{"dist":"北京","ecogrp":"东部"},{"dist":"天津","ecogrp":"东部"},{"dist":"河北","ecogrp":"东部"},{"dist":"山西","ecogrp":"中部"},{"dist":"内蒙古","ecogrp":"西部"},{"dist":"辽宁","ecogrp":"东北"},{"dist":"吉林","ecogrp":"东北"},{"dist":"黑龙江","ecogrp":"东北"},{"dist":"上海","ecogrp":"东部"},{"dist":"江苏","ecogrp":"东部"},{"dist":"浙江","ecogrp":"东部"},{"dist":"安徽","ecogrp":"中部"},{"dist":"福建","ecogrp":"东部"},{"dist":"江西","ecogrp":"中部"},{"dist":"山东","ecogrp":"东部"},{"dist":"河南","ecogrp":"中部"},{"dist":"湖北","ecogrp":"中部"},{"dist":"湖南","ecogrp":"中部"},{"dist":"广东","ecogrp":"东部"},{"dist":"广西","ecogrp":"西部"},{"dist":"海南","ecogrp":"东部"},{"dist":"重庆","ecogrp":"西部"},{"dist":"四川","ecogrp":"西部"},{"dist":"贵州","ecogrp":"西部"},{"dist":"云南","ecogrp":"西部"},{"dist":"西藏","ecogrp":"西部"},{"dist":"陕西","ecogrp":"西部"},{"dist":"甘肃","ecogrp":"西部"},{"dist":"青海","ecogrp":"西部"},{"dist":"宁夏","ecogrp":"西部"},{"dist":"新疆","ecogrp":"西部"},];function exeSQL(index){var sql=$("#ta"+index).val();var res={},succ=false;try{res=alasql(sql);console.log(res);succ=true;}catch(err){console.log(err);$("#msg"+index).html(err.message);succ=false;}
if(succ){var html=jsonToHTMLTable(res);console.log(html);$("#rs"+index).html(html);$("#rs"+index+" table").addClass("tbl");$("#msg"+index).html("");}
if(expectedrs[index]){if(_.isEqual(expectedrs[index],res)){$("#testmsg"+index).html("<span class='succ'>恭喜你答对啦 ヾ(o´∀｀o)ﾉ </span>");}else{$("#testmsg"+index).html("<span class='fail'>好像不对啊，再想想吧 ╮(╯﹏╰）╭</span>");}}
return res;}
$(function(){$("button[id^='btn']").each(function(){$(this).bind("click",function(){var index=$(this).attr("id").substring(3);var sql=$("#ta"+index).val();if(sql===""){$("#msg"+index).html("<span class='fail'>SQL不能为空</span>");}else{exeSQL(index);}});});$("button[id^='clearbtn']").each(function(){$(this).bind("click",function(){var index=$(this).attr("id").substring(8);$("#msg"+index).html("");$("#rs"+index).html("");$("#testmsg"+index).html("");});});$("textarea").each(function(){$(this).bind("keydown",function(e){var index=$(this).attr("id").substring(2);console.log(index);if(e.keyCode==13&&e.ctrlKey){exeSQL(index);}});});});</script></div><div class=my-4><a href=/tags/sql/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 mr-2 hover:text-eureka">#SQL</a>
<a href=/tags/%E7%BB%83%E4%B9%A0/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 mr-2 hover:text-eureka">#练习</a>
<a href=/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 mr-2 hover:text-eureka">#数据库</a>
<a href=/tags/database/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 mr-2 hover:text-eureka">#Database</a></div><div class="flex flex-col md:flex-row md:justify-between -mx-2 mt-4 px-2 pt-4 border-t"><div><span class="block font-bold">上一页</span>
<a href=/posts/new-look/ class=block>新年新气象，老师博客改版啦！</a></div><div class="md:text-right mt-4 md:mt-0"><span class="block font-bold">下一页</span>
<a href=/posts/datamining-summary/ class=block>数据仓库与挖掘技术课程资源汇总</a></div></div></div><div class=col-span-2><div class="sticky top-16 z-10 hidden lg:block px-6 py-4 bg-primary-bg"><span class="text-lg font-semibold">本页内容</span></div><div class="sticky-toc hidden lg:block px-6 pb-6"><nav id=TableOfContents><ul><li><a href=#sql-练习-1>SQL 练习 1</a></li><li><a href=#版本>【版本】</a><ul><li><a href=#实验名称>【实验名称】</a></li><li><a href=#实验目的>【实验目的】</a></li><li><a href=#实验环境>【实验环境】</a></li><li><a href=#实验数据>【实验数据】</a></li><li><a href=#实验步骤>【实验步骤】</a></li></ul></li></ul></nav></div><script>window.addEventListener('DOMContentLoaded',()=>{enableStickyToc();});</script></div><div class="col-span-2 lg:col-span-6 bg-secondary-bg rounded p-6"><h2 class="text-lg font-semibold mb-4">相关</h2><div class=content><a href=/docs/spark-exp/spark-exp05/>第五章 SparkSQL 实验手册</a><br></div></div></div><div id=outerdiv style=position:fixed;top:0;left:0;background:rgba(0,0,0,.7);z-index:2;width:100%;height:100%;display:none><div id=innerdiv style=position:absolute><img id=bigimg style="border:5px solid #fff" src></div></div><script>document.addEventListener('DOMContentLoaded',()=>{hljs.initHighlightingOnLoad();$("img").click(function(){var _this=$(this);imgShow("#outerdiv","#innerdiv","#bigimg",_this);});})</script></div></div></main><footer class=pl-scrollbar><div class="w-full max-w-screen-xl mx-auto"><div class="text-center p-6 pin-b"><p class="text-sm text-tertiary-text">&copy; 2021 <a href=https://www.wangchucheng.com/>C. Wang</a> and <a href=https://www.ruiqima.com/>R. Ma</a>
&#183; Powered by the <a href=https://github.com/wangchucheng/hugo-eureka class=hover:text-eureka>Eureka</a> theme for <a href=https://gohugo.io class=hover:text-eureka>Hugo</a></p></div></div></footer></body></html>