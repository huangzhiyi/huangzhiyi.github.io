<!doctype html><html lang=zh><meta charset=utf-8><meta name=viewport content="width=device-width"><title>批量转换word文件（doc,docx)为pdf文件 | Heis</title><meta name=generator content="Hugo Eureka 0.8.4"><link rel=stylesheet href=/css/eureka.min.css><script defer src=/js/eureka.min.js></script><script src=/static/js/jquery-3.6.0.min.js></script><script src=/static/js/heis.js?230321></script><link rel=stylesheet href=/static/css/heis.css?230321 media=all onload="this.media='all';this.onload=null" crossorigin><link rel=stylesheet href=/static/css/print.css?230413 media=print crossorigin><link rel=stylesheet href=/static/css/highlight-css/solarized-light.min.css media=print onload="this.media='all';this.onload=null" crossorigin><script defer src=/static/js/highlight.min.js crossorigin></script><script defer src=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/js/all.min.js integrity="sha256-uNYoXefWRqv+PsIF/OflNmwtKM4lStn9yrz2gVl6ymo=" crossorigin></script><script defer src=/static/js/highlightjs-line-numbers.min.js></script><link rel=icon type=image/png sizes=32x32 href=/images/icon_huddfe7d1590fd89155f46b33625956ea5_4357_32x32_fill_box_center_2.png><link rel=apple-touch-icon sizes=180x180 href=/images/icon_huddfe7d1590fd89155f46b33625956ea5_4357_180x180_fill_box_center_2.png><meta name=description content="批量转换word（docx）为pdf文件，开源，完全免费，非在线。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"文章","item":"/posts/"},{"@type":"ListItem","position":2,"name":"批量转换word文件（doc,docx)为pdf文件","item":"/posts/batch-convert-docx-to-pdf/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/batch-convert-docx-to-pdf/"},"headline":"批量转换word文件（doc,docx)为pdf文件 | Heis","datePublished":"2022-03-21T10:42:51+08:00","dateModified":"2022-03-21T10:42:51+08:00","wordCount":1782,"author":{"@type":"Person","name":"heis"},"publisher":{"@type":"Person","name":"C. Wang","logo":{"@type":"ImageObject","url":"/images/icon.png"}},"description":"批量转换word（docx）为pdf文件，开源，完全免费，非在线。"}</script><meta property="og:title" content="批量转换word文件（doc,docx)为pdf文件 | Heis"><meta property="og:type" content="article"><meta property="og:image" content="/images/icon.png"><meta property="og:url" content="/posts/batch-convert-docx-to-pdf/"><meta property="og:description" content="批量转换word（docx）为pdf文件，开源，完全免费，非在线。"><meta property="og:locale" content="zh"><meta property="og:site_name" content="Heis"><meta property="article:published_time" content="2022-03-21T10:42:51+08:00"><meta property="article:modified_time" content="2022-03-21T10:42:51+08:00"><meta property="article:section" content="posts"><meta property="article:tag" content="pdf"><meta property="article:tag" content="转换"><meta property="article:tag" content="word"><meta property="article:tag" content="doc"><meta property="article:tag" content="docx"><script>var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?f58b6a2675cf52000232edb4d109eccc";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script><body class="flex flex-col min-h-screen"><header id=headerctn class="fixed flex items-center w-full pl-scrollbar z-50 bg-secondary-bg shadow-sm"><div class="w-full max-w-screen-xl mx-auto"><script>let storageColorScheme=localStorage.getItem("lightDarkMode")
if(((storageColorScheme=='Auto'||storageColorScheme==null)&&window.matchMedia("(prefers-color-scheme: dark)").matches)||storageColorScheme=="Dark"){document.getElementsByTagName('html')[0].classList.add('dark')}</script><nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0"><a href=/ class="mr-6 text-primary-text text-xl font-bold">Heis</a>
<button id=navbar-btn class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
<i class="fas fa-bars"></i></button><div id=target class="hidden block md:flex md:flex-grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20"><div class="md:flex md:h-16 text-sm md:flex-grow pb-4 md:pb-0 border-b md:border-b-0"><a href=/posts/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 selected-menu-item mr-4">文章</a>
<a href=/docs/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent mr-4">系列</a></div><div class=flex><div class="relative pt-4 md:pt-0"><div class="cursor-pointer hover:text-eureka" id=lightDarkMode><i class="fas fa-adjust"></i></div><div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id=is-open></div><div class="absolute flex flex-col left-0 md:left-auto right-auto md:right-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40" id=lightDarkOptions><span class="px-4 py-1 hover:text-eureka" name=Light>浅色</span>
<span class="px-4 py-1 hover:text-eureka" name=Dark>深色</span>
<span class="px-4 py-1 hover:text-eureka" name=Auto>自动</span></div></div></div></div><div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id=is-open-mobile></div></nav><script>let element=document.getElementById('lightDarkMode')
if(storageColorScheme==null||storageColorScheme=='Auto'){document.addEventListener('DOMContentLoaded',()=>{window.matchMedia("(prefers-color-scheme: dark)").addEventListener('change',switchDarkMode)})}else if(storageColorScheme=="Light"){element.firstElementChild.classList.remove('fa-adjust')
element.firstElementChild.setAttribute("data-icon",'sun')
element.firstElementChild.classList.add('fa-sun')}else if(storageColorScheme=="Dark"){element.firstElementChild.classList.remove('fa-adjust')
element.firstElementChild.setAttribute("data-icon",'moon')
element.firstElementChild.classList.add('fa-moon')}
document.addEventListener('DOMContentLoaded',()=>{getcolorscheme();switchBurger();});</script></div></header><main class="flex-grow pt-16"><div class=pl-scrollbar><div class="w-full max-w-screen-xl lg:px-4 xl:px-8 mx-auto"><div class="grid grid-cols-2 lg:grid-cols-8 gap-4 lg:pt-12"><div class="col-span-2 lg:col-span-6 bg-secondary-bg rounded px-6 py-8"><h1 class="font-bold text-3xl text-primary-text">批量转换word文件（doc,docx)为pdf文件</h1><div class="flex flex-wrap flex-row items-center mt-2 text-tertiary-text"><div class="mr-6 my-2"><i class="fas fa-calendar mr-1"></i><span>2022-03-21</span></div><div class="mr-6 my-2"><i class="fas fa-clock mr-1"></i><span>4分钟阅读时长</span></div><div class="mr-6 my-2"><i class="fas fa-folder mr-1"></i><a href=/categories/pdf%E6%93%8D%E4%BD%9C/ class=hover:text-eureka>PDF操作</a></div></div><div class=content><p>在某度搜索到的“批量转换 Word 文档”很多都是挂着免费的旗号，实际还是收费或者限制文件转换数量的。</p><p>这里分享一个开源，完全免费，不用在线上传，而且不用安装的方案。</p><h2 id=1-保存脚本>1. 保存脚本</h2><ul><li>复制以下脚本，保存为<code>DOC2PDF.vbs</code>。</li></ul><pre><code>Dim fso,fld,Path
Set fso = WScript.CreateObject(&quot;Scripting.Filesystemobject&quot;)
Path = fso.GetParentFolderName(WScript.ScriptFullName) '获取脚本所在文件夹字符串
Set fld=fso.GetFolder(Path) '通过路径字符串获取文件夹对象

Dim Sum,IsChooseDelete,ThisTime
Sum = 0
Dim LogFile
Set LogFile= fso.opentextFile(&quot;log.txt&quot;,8,true)

Dim List
Set List= fso.opentextFile(&quot;ConvertFileList.txt&quot;,2,true)

Call LogOut(&quot;开始遍历文件&quot;)
Call TreatSubFolder(fld) '调用该过程进行递归遍历该文件夹对象下的所有文件对象及子文件夹对象

Sub LogOut(msg)
    ThisTime=Now
    LogFile.WriteLine(year(ThisTime) &amp; &quot;-&quot; &amp; Month(ThisTime) &amp; &quot;-&quot; &amp; day(ThisTime) &amp; &quot; &quot; &amp; Hour(ThisTime) &amp; &quot;:&quot; &amp; Minute(ThisTime) &amp; &quot;:&quot; &amp; Second(ThisTime) &amp; &quot;: &quot; &amp; msg)
End Sub

Sub TreatSubFolder(fld) 
    Dim File
    Dim ts
    For Each File In fld.Files '遍历该文件夹对象下的所有文件对象
        If UCase(fso.GetExtensionName(File)) =&quot;DOC&quot; or UCase(fso.GetExtensionName(File)) =&quot;DOCX&quot; Then
            List.WriteLine(File.Path)
            Sum = Sum + 1
        End If
    Next
    Dim subfld
    For Each subfld In fld.SubFolders '递归遍历子文件夹对象
        TreatSubFolder subfld
    Next
End Sub
List.close

Call LogOut(&quot;文件遍历已完成，已找到&quot; &amp; Sum &amp; &quot;个word文档&quot;)

If MsgBox(&quot;文件遍历已完成，已找到&quot; &amp; Sum &amp; &quot;个word文档，详细列表在&quot; &amp; vbCrlf &amp; fso.GetFolder(Path).Path &amp; &quot;\ConvertFileList.txt&quot; &amp; vbCrlf &amp; &quot;您可以自行修改列表以增删要转换的文档&quot; &amp; vbCrlf &amp; vbCrlf &amp; &quot;是否将这些文档转换为PDF格式？&quot;, vbYesNo + vbInformation, &quot;文档遍历完成&quot;) = vbYes Then
    If MsgBox(&quot;是否在转换完毕后删除DOC文档?&quot;, vbYesNo+vbInformation, &quot;是否在转换完毕后删除源文档?&quot;) = vbYes Then
        IsChooseDelete = MsgBox(&quot;请再次确认，是否在转换完毕后删除DOC文档?&quot;, vbYesNo + vbExclamation, &quot;是否在转换完毕后删除源文档?&quot;)
    End If
else
    Msgbox(&quot;已取消转换操作&quot;)
    Wscript.Quit
End If
MsgBox &quot;请在开始转换前退出所有Word文档避免文档占用错误发生&quot;, vbOKOnly + vbExclamation, &quot;警告&quot;

'创建Word对象，兼容WPS
Const wdFormatPDF = 17
On Error Resume Next
Set WordApp = CreateObject(&quot;Word.Application&quot;)
' try to connect to wps
If WordApp Is Nothing Then '兼容WPS
    Set WordApp = CreateObject(&quot;WPS.Application&quot;)
    If WordApp Is Nothing Then
        Set WordApp = CreateObject(&quot;KWPS.Application&quot;)
        If WordApp Is Nothing Then
            MsgBox &quot;本程序依赖office 2010及以上版本，兼容WPS，&quot; &amp; vbCrlf &amp; &quot;请在使用本程序前安装office word 或WPS,否则本程序无法使用&quot;, vbCritical + vbOKOnly, &quot;无法转换&quot;
            WScript.Quit
        End If
    End If
End If
On Error Goto 0

WordApp.Visible=false '设置视图不可见

Sum = 0
Dim FilePath,FileLine
Set List= fso.opentextFile(&quot;ConvertFileList.txt&quot;,1,true)
Do While List.AtEndOfLine &lt;&gt; True 
    FileLine=List.ReadLine
    If FileLine &lt;&gt; &quot;&quot; and Mid(FileLine,1,2) &lt;&gt; &quot;~$&quot; Then
        Sum = Sum + 1 '获取用户修改后的文件列表行数
    End If
loop
List.close
MsgBox &quot;现在开始转换，若是在运行过程中弹出Word窗口&quot;&amp;vbCrlf&amp;&quot;请直接最小化Word窗口，不要关闭!&quot;&amp;vbCrlf&amp;&quot;请直接最小化Word窗口，不要关闭!&quot;&amp;vbCrlf&amp;&quot;请直接最小化Word窗口，不要关闭!&quot;&amp;vbCrlf&amp;&quot;重要的事情说三遍！关闭会导致脚本退出&quot;, vbOKOnly + vbExclamation, &quot;警告&quot;
Dim Finished
Finished = 0
Set List= fso.opentextFile(&quot;ConvertFileList.txt&quot;,1,true)
Do While List.AtEndOfLine &lt;&gt; True 
    FilePath=List.ReadLine
    If Mid(FilePath,1,2) &lt;&gt; &quot;~$&quot; Then '不处理word临时文件
        Set objDoc = WordApp.Documents.Open(FilePath)
        'WordApp.Visible=false '设置视图不可见（避免运行时因为各种问题导致的可见）
        '上面这行有问题，现在遇到大批量有啥宏定义的运行起来就是一闪一闪的，还不如没有
        If WordApp.Visible = true Then
            WordApp.ActiveDocument.ActiveWindow.WindowState = 2 'wdWindowStateMinimize
        End If
        objDoc.SaveAs Left(FilePath,InstrRev(FilePath,&quot;.&quot;)) &amp; &quot;pdf&quot;, wdFormatPDF '另存为PDF文档
        LogOut(&quot;文档&quot; &amp; FilePath &amp; &quot;已转换完成。(&quot; &amp; Finished &amp; &quot;/&quot; &amp; Sum &amp; &quot;)&quot;)
        WordApp.ActiveDocument.Close  
        Finished = Finished + 1
    End If
    If IsChooseDelete = vbYes Then
        fso.deleteFile FilePath
        LogOut(&quot;文件&quot; &amp; FilePath &amp; &quot;已被成功删除&quot;)
    End If
loop
'扫尾处理开始
List.close
LogOut(&quot;文档转换已完成&quot;)
LogFile.close 
'ConvertFileList.txt和log.txt要自动删除的请去掉下面两行开头单引号
'fso.deleteFile &quot;ConvertFileList.txt&quot;
'fso.deleteFile &quot;log.txt&quot;

Dim Msg
Msg = &quot;已成功转换&quot; &amp; Finished &amp; &quot;个文件&quot;
If IsChooseDelete = vbYes Then
    Msg=Msg + &quot;并成功删除源文件&quot;
End If
MsgBox Msg &amp; vbCrlf &amp; &quot;日志文件在&quot; &amp; fso.GetFolder(Path).Path &amp; &quot;\log.txt&quot;
Set fso = nothing
WordApp.Quit
Wscript.Quit
</code></pre><blockquote><p>.vbs后缀是指 VBScript 脚本。</p></blockquote><h2 id=2-运行脚本>2. 运行脚本</h2><ul><li><p>把<code>DOC2PDF.vbs</code>脚本文件放在 word 文档的文件夹中双击运行。按照提示即可把文件夹内的所有 word 文档生成为对应的 pdf 格式文档。
<img src=/static/img/conv-word-pdf/Snipaste_2022-03-02_15-21-13.png alt></p></li><li><p>当遇到提醒是否转换完毕删除word文档，这里要注意选择，以免误删原文档。
<img src=/static/img/conv-word-pdf/Snipaste_2022-03-02_17-34-45.png alt>
<img src=/static/img/conv-word-pdf/Snipaste_2022-03-02_17-37-19.png alt>
<img src=/static/img/conv-word-pdf/Snipaste_2022-03-02_17-38-29.png alt>
<img src=/static/img/conv-word-pdf/Snipaste_2022-03-02_17-39-03.png alt></p></li></ul><h2 id=3-原作者-github-地址>3. 原作者 GitHub 地址</h2><p><a href=https://github.com/cxgreat2014/VBScript_DOC2PDF target=_blank><a href=https://github.com/cxgreat2014/VBScript_DOC2PDF>https://github.com/cxgreat2014/VBScript_DOC2PDF</a></a></p></div><div class=my-4><a href=/tags/pdf/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 mr-2 hover:text-eureka">#pdf</a>
<a href=/tags/%E8%BD%AC%E6%8D%A2/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 mr-2 hover:text-eureka">#转换</a>
<a href=/tags/word/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 mr-2 hover:text-eureka">#word</a>
<a href=/tags/doc/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 mr-2 hover:text-eureka">#doc</a>
<a href=/tags/docx/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 mr-2 hover:text-eureka">#docx</a></div><div class=py-2><div class="flex flex-col md:flex-row items-center my-8"><a href=/authors/heis/ class="w-24 h-24 md:mr-4"><img src=/static/img/authors/heis.png class="w-full bg-primary-bg rounded-full" alt=Avatar></a><div class="w-full md:w-auto mt-4 md:mt-0"><a href=/authors/heis/ class="block font-bold text-lg pb-1 mb-2 border-b">黄老师</a>
<span class="block pb-2"></span><a href=mailto:heishuangzy@qq.com class=mr-1><i class="fas fa-envelope"></i></a><a href=https://gitee.com/heis/ class=mr-1><i class="fab fa-git"></i></a><a href=http://heis.gitee.io/ class=mr-1><i class="fas fa-blog"></i></a></div></div></div><div class="flex flex-col md:flex-row md:justify-between -mx-2 mt-4 px-2 pt-4 border-t"><div id=presec></div><div id=nextsec class="md:text-right mt-4 md:mt-0"><span class="block font-bold">下一页</span>
<a href=/posts/new-look/ class=block>新年新气象，老师博客改版啦！</a></div></div></div><div class=col-span-2><div class="sticky top-16 z-10 hidden lg:block px-6 py-4 bg-primary-bg"><span class="text-lg font-semibold">本页内容</span></div><div class="sticky-toc hidden lg:block px-6 pb-6"><nav id=TableOfContents><ul><li><a href=#1-保存脚本>1. 保存脚本</a></li><li><a href=#2-运行脚本>2. 运行脚本</a></li><li><a href=#3-原作者-github-地址>3. 原作者 GitHub 地址</a></li></ul></nav></div><script>window.addEventListener('DOMContentLoaded',()=>{enableStickyToc();});</script></div></div><div id=outerdiv style=position:fixed;top:0;left:0;background:rgba(0,0,0,.7);z-index:2;width:100%;height:100%;display:none><div id=innerdiv style=position:absolute><img id=bigimg style="border:5px solid #fff" src></div></div><script>document.addEventListener('DOMContentLoaded',()=>{hljs.initHighlightingOnLoad();$("img").click(function(){var _this=$(this);imgShow("#outerdiv","#innerdiv","#bigimg",_this);});})</script><script src=/static/js/clipboard.min.js></script><script src=/static/js/codecopy.bundle.js?129></script></div></div></main><footer class=pl-scrollbar><div class="w-full max-w-screen-xl mx-auto"><div class="text-center p-6 pin-b"><p class="text-sm text-tertiary-text"></p></div></div></footer></body></html>